# Default values for munki-fileserver
# This is a YAML-formatted file.

# Storage configuration
storage:
  size: 20Gi
  storageClass: local-path  # Using local-path provisioner
  # Note: local-path typically supports ReadWriteOnce only
  # Both pods will need to be scheduled on the same node to share the volume
  accessMode: ReadWriteOnce

# SFTP Server configuration
sftp:
  enabled: true
  image:
    # atmoz/sftp latest tag should support multi-arch including ARM64
    # The Docker image will automatically pull the correct architecture
    repository: atmoz/sftp
    tag: latest
    pullPolicy: IfNotPresent
  
  # Node selector to ensure pod runs on ARM64 nodes
  # Adjust the label key/value based on your cluster's node labels
  nodeSelector:
    kubernetes.io/arch: arm64
  
  users:
    - name: munki
      password: munkipassword
      uid: 1000
      gid: 1000
  
  service:
    type: LoadBalancer
    port: 22
    loadBalancerIP: "192.168.8.25"
  
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"
      cpu: "100m"

# NGINX Server configuration
nginx:
  enabled: true
  image:
    repository: nginx
    tag: alpine
    pullPolicy: IfNotPresent
  
  # Node selector to ensure pod runs on ARM64 nodes (same as SFTP for volume sharing)
  nodeSelector:
    kubernetes.io/arch: arm64
  
  service:
    type: LoadBalancer
    port: 80
    loadBalancerIP: "192.168.8.25"
  
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"
      cpu: "100m"

# Shared volume mount path
volume:
  mountPath: /munki

